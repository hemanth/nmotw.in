
<!DOCTYPE HTML>
<html lang="en-GB">

<head>
    <meta charset="utf-8">
    <title>compactr - NMOTW</title>
    <meta name="author" content="Hemanth.HM"> 

    <meta name="description" content="compactr Schema based serialization made easy! What is this and why does it matter? [From the horse's mouth] Protocol Buffers are awesome. Having &hellip;">   

    <!-- twitter card -->
    <meta name="twitter:card" content="Node module of the week.">
    <meta name="twitter:site" content="@nmotw">
    <meta name="twitter:creator" content="@nmotw">
    <meta name="twitter:title" content="compactr - NMOTW">
    <meta name="twitter:url" content="http://nmotw.in//github/compactr/">
    <meta name="twitter:description" content="compactr Schema based serialization made easy! What is this and why does it matter? [From the horse's mouth] Protocol Buffers are awesome. Having &hellip;">

    <!-- open graph -->
    <meta property="og:title" content="compactr - NMOTW" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://nmotw.in//github/compactr/" />
    <meta property="og:site_name" content="Node module of the week." />
    <meta property="og:description" content="compactr Schema based serialization made easy! What is this and why does it matter? [From the horse's mouth] Protocol Buffers are awesome. Having &hellip;" />

    

    <!-- rest -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link href="/atom.xml" rel="alternate" title="NMOTW" type="application/atom+xml">
    <link rel="canonical" href="http://nmotw.in//github/compactr/">
    <link href="/favicon.png" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    

</head>


<body>
	<header id="header" class="inner"><h1><a href="/">NMOTW</a></h1>
<span class="tagline">Node Module Of The Week!</span>
<!-- <nav id="main-nav"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
	<li><a href="/github/subscribe">subscribe</a></li>
</ul>
</nav> -->
<!-- <nav id="mobile-nav"> -->
<!-- 	<div class="alignleft menu"> -->
<!-- 		<a class="button">Menu</a> -->
<!-- 		<div class="container"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
	<li><a href="/github/subscribe">subscribe</a></li>
</ul>
</div> -->
<!-- 	</div> -->
<!-- </nav> -->


</header>

	<div id="content" class="inner"><article class="post">
	<header>
		<h2 class="title">Compactr</h2>
		<div class="meta date">








  


<time datetime="2017-05-12T16:17:16-07:00" pubdate data-updated="true">May 12<span>th</span>, 2017</time></div>
	</header>
	<div class="entry-content"><h1><a href="https://www.npmjs.com/package/compactr">compactr</a></h1>

<blockquote><p>Schema based serialization made easy!</p></blockquote>

<p><strong>What is this and why does it matter?</strong> [From the horse's mouth]</p>

<p>Protocol Buffers are awesome. Having schemas to deflate and inflate data while maintaining some kind of validation is a great concept.
Compactr's goal is to build on that to better suit Node development and reduce repetition by allowing you to build schemas for your data directly in your scripting language.
For example, if you have a DB schema for a model, you could use that directly as a schema for Compactr.</p>

<p><strong>Get it:</strong> <code>npm install --save compactr</code></p>

<p><strong>Sample usage:</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">Compactr</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;compactr&quot;</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">Schema</span> <span class="o">=</span> <span class="nx">Compactr</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">bool</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">num</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">str</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">arr</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span> <span class="p">}</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="nx">schema</span><span class="o">:</span> <span class="p">{</span> <span class="nx">sub</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// decode encoded.</span>
</span><span class='line'><span class="nx">Schema</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">write</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">bool</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">num</span><span class="o">:</span> <span class="mf">23.23</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">str</span><span class="o">:</span> <span class="s1">&#39;hello world&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
</span><span class='line'>    <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">sub</span><span class="o">:</span> <span class="s1">&#39;way&#39;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}).</span><span class="nx">array</span><span class="p">());</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">Compactr</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;compactr&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Defining a schema</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">userSchema</span> <span class="o">=</span> <span class="nx">Compactr</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">id</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">name</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span> <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// Encoding</span>
</span><span class='line'><span class="nx">userSchema</span><span class="p">.</span><span class="nx">write</span><span class="p">({</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">123</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;John&#39;</span> <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Get the schema header bytes (for partial loads)</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">header</span> <span class="o">=</span> <span class="nx">userSchema</span><span class="p">.</span><span class="nx">headerBytes</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Get the partial load bytes</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">partial</span> <span class="o">=</span> <span class="nx">userSchema</span><span class="p">.</span><span class="nx">contentBytes</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Get the full header + content bytes</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">userSchema</span><span class="p">.</span><span class="nx">bytes</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// Decoding (full)</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">userSchema</span><span class="p">.</span><span class="nx">decode</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Decoding (partial)</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">userSchema</span><span class="p">.</span><span class="nx">decode</span><span class="p">(</span><span class="nx">header</span><span class="p">,</span> <span class="nx">partial</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>GIF FTW!</strong></p>

<p><img src="/images/compactr/compactr.gif" alt="compactr" /></p>
</div>

</article>
<a href="https://github.com/hemanth/nmotw.in/issues">Suggest a module</a>

	
	<div class="share">
	  <ul>
	  <li>
  <a href="https://twitter.com/intent/tweet?text=compactr by @nodemotw&url=http://nmotw.in/compactr/" title="Share compactr on Twitter">
    <img src="/images/social/twitter.png" />
  </a>
</li>

	  <li>
  <a href="https://www.facebook.com/sharer.php?u=http://nmotw.in/compactr/" title="Share compactr on Facebook">
    <img src="/images/social/facebook.png" />
  </a>
</li>

	  <li>
  <a href="https://plus.google.com/share?url=http://nmotw.in/compactr/" title="Share compactr on Google Plus">
    <img src="/images/social/google.png" />
  </a>
</li>

	  </ul>
	</div>




<section id="comment">
      <h1 class="title">Comments</h1>
     <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner"><br>
<br>
<br>
<br>
&copy; 2018

   <a href="http://h3manth.com">Hemanth.HM</a>
   <br>
   <a href="https://github.com/hemanth/nmotw.in/issues">Suggest a module</a>
   <br>
   <a href="http://nmotw.in/subscribe/">Subscribe</a>

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/hyphenator.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'nmotw';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://nmotw.in//github/compactr/';
        var disqus_url = 'http://nmotw.in//github/compactr/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-7949129-5']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




</body>
<script>
  $(document).ready(function() {
  // Make images center
  $('p:has(img)').css('text-align', 'center');
  });
</script>
</html>
